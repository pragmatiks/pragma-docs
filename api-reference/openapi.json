{
  "openapi": "3.1.0",
  "info": {
    "title": "Pragma API",
    "version": "0.1.0"
  },
  "paths": {
    "/health": {
      "get": {
        "summary": "Health",
        "description": "Health check endpoint for load balancers and monitoring.\n\nReturns:\n    Status dictionary indicating service availability.",
        "operationId": "health",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": {
                    "type": "string"
                  },
                  "type": "object",
                  "title": "Response Health"
                }
              }
            }
          }
        }
      }
    },
    "/ops/dead-letter": {
      "get": {
        "tags": [
          "ops"
        ],
        "summary": "List Dead Letter Events",
        "description": "List all dead letter events for authenticated tenant.\n\nAuthentication required via Clerk JWT token. Events automatically scoped\nto user's organization namespace.\n\nReturns:\n    List of dead letter events, optionally filtered by provider.",
        "operationId": "ops-list_dead_letter_events",
        "parameters": [
          {
            "name": "provider",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "description": "Filter by provider name",
              "title": "Provider"
            },
            "description": "Filter by provider name"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/DeadLetterEvent"
                  },
                  "title": "Response Ops-List Dead Letter Events"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "ops"
        ],
        "summary": "Bulk Delete Dead Letter Events",
        "description": "Bulk delete dead letter events.\n\nRequires either `?all=true` to delete all events or `?provider=x` to delete\nevents for a specific provider. Returns count of deleted events.\n\nAuthentication required. Only deletes events within user's organization namespace.\n\nReturns:\n    Dictionary with count of deleted events.\n\nRaises:\n    HTTPException: 400 if neither `all=true` nor `provider` specified.",
        "operationId": "ops-bulk_delete_dead_letter_events",
        "parameters": [
          {
            "name": "all",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "boolean"
                },
                {
                  "type": "null"
                }
              ],
              "description": "Delete all events",
              "title": "All"
            },
            "description": "Delete all events"
          },
          {
            "name": "provider",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "description": "Delete events for specific provider",
              "title": "Provider"
            },
            "description": "Delete events for specific provider"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "integer"
                  },
                  "title": "Response Ops-Bulk Delete Dead Letter Events"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/ops/dead-letter/{event_id}": {
      "get": {
        "tags": [
          "ops"
        ],
        "summary": "Get Dead Letter Event",
        "description": "Get a single dead letter event by event ID.\n\nAuthentication required. Only returns events within user's organization namespace.\n\nReturns:\n    Dead letter event with error details and payload.\n\nRaises:\n    HTTPException: 404 if event not found.",
        "operationId": "ops-get_dead_letter_event",
        "parameters": [
          {
            "name": "event_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Event Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DeadLetterEvent"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "ops"
        ],
        "summary": "Delete Dead Letter Event",
        "description": "Delete a single dead letter event.\n\nPermanently removes the event from dead letter storage.\nIdempotent operation - succeeds even if event doesn't exist.\n\nAuthentication required. Only deletes events within user's organization namespace.",
        "operationId": "ops-delete_dead_letter_event",
        "parameters": [
          {
            "name": "event_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Event Id"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Successful Response"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/ops/dead-letter/{event_id}/retry": {
      "post": {
        "tags": [
          "ops"
        ],
        "summary": "Retry Dead Letter Event",
        "description": "Retry a single dead letter event.\n\nCreates a new OutboxEvent from the dead letter event and deletes\nthe dead letter event. The new event will be picked up by the\noutbox publisher for processing.\n\nAuthentication required. Only retries events within user's organization namespace.\n\nReturns:\n    Newly created OutboxEvent queued for processing.\n\nRaises:\n    HTTPException: 404 if event not found.",
        "operationId": "ops-retry_dead_letter_event",
        "parameters": [
          {
            "name": "event_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Event Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OutboxEvent"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/ops/dead-letter/retry-all": {
      "post": {
        "tags": [
          "ops"
        ],
        "summary": "Retry All Dead Letter Events",
        "description": "Retry all dead letter events for authenticated tenant.\n\nCreates new OutboxEvents from all dead letter events and deletes\nthe original dead letter events. Events will be picked up by the\noutbox publisher for processing.\n\nAuthentication required. Only retries events within user's organization namespace.\n\nReturns:\n    Dictionary with count of retried events.",
        "operationId": "ops-retry_all_dead_letter_events",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": {
                    "type": "integer"
                  },
                  "type": "object",
                  "title": "Response Ops-Retry All Dead Letter Events"
                }
              }
            }
          }
        }
      }
    },
    "/providers/{provider_id}/push": {
      "post": {
        "tags": [
          "providers"
        ],
        "summary": "Push Provider",
        "description": "Push provider code and trigger a build.\n\nUploads provider source code and starts a build process.\n\nArgs:\n    provider_id: Unique identifier for the provider.\n    code: Provider source code archive.\n\nReturns:\n    PushResponse with version and job name for tracking.\n\nRaises:\n    HTTPException: 400 if upload or build creation fails.",
        "operationId": "providers-push_provider",
        "parameters": [
          {
            "name": "provider_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Provider Id"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "$ref": "#/components/schemas/Body_providers-push_provider"
              }
            }
          }
        },
        "responses": {
          "202": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PushResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/providers/{provider_id}/builds/{job_name}": {
      "get": {
        "tags": [
          "providers"
        ],
        "summary": "Get Build Status",
        "description": "Get the status of a build job.\n\nArgs:\n    provider_id: Provider identifier.\n    job_name: Build job identifier.\n\nReturns:\n    BuildResult with current build state.\n\nRaises:\n    HTTPException: 404 if build job not found.",
        "operationId": "providers-get_build_status",
        "parameters": [
          {
            "name": "provider_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Provider Id"
            }
          },
          {
            "name": "job_name",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Job Name"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BuildResult"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/providers/{provider_id}/builds/{job_name}/logs": {
      "get": {
        "tags": [
          "providers"
        ],
        "summary": "Get Build Logs",
        "description": "Stream logs from a build job.\n\nReturns build logs as a streaming text response for real-time\nmonitoring of build progress.\n\nArgs:\n    provider_id: Provider identifier.\n    job_name: Build job identifier.\n\nReturns:\n    StreamingResponse with build logs.\n\nRaises:\n    HTTPException: 404 if build job not found, 500 if streaming fails.",
        "operationId": "providers-get_build_logs",
        "parameters": [
          {
            "name": "provider_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Provider Id"
            }
          },
          {
            "name": "job_name",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Job Name"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/providers/{provider_id}/deployment": {
      "get": {
        "tags": [
          "providers"
        ],
        "summary": "Get Deployment Status",
        "description": "Get the deployment status for a provider.\n\nArgs:\n    provider_id: Unique identifier for the provider.\n    service: Provider service for deployment operations.\n\nReturns:\n    DeploymentResult with current deployment state.\n\nRaises:\n    HTTPException: 404 if deployment not found.",
        "operationId": "providers-get_deployment_status",
        "parameters": [
          {
            "name": "provider_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Provider Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DeploymentResult"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/providers/{provider_id}/deploy": {
      "post": {
        "tags": [
          "providers"
        ],
        "summary": "Deploy Provider",
        "description": "Deploy a provider to a specific version.\n\nDeploys the provider and activates its resource schemas.\nIf no version is specified, deploys the latest successful build.\n\nArgs:\n    provider_id: Unique identifier for the provider.\n    request: Deploy request containing the version to deploy.\n\nReturns:\n    DeploymentResult with deployment state.\n\nRaises:\n    HTTPException: 404 if version not found, 500 if deployment fails.",
        "operationId": "providers-deploy_provider",
        "parameters": [
          {
            "name": "provider_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Provider Id"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DeployRequest"
              }
            }
          }
        },
        "responses": {
          "202": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DeploymentResult"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/resources/": {
      "get": {
        "tags": [
          "resources"
        ],
        "summary": "List Resources",
        "description": "List all resources for authenticated tenant.\n\nAuthentication required via Clerk JWT token. Resources automatically scoped\nto user's organization namespace.\n\nReturns:\n    List of resources matching filters, ordered by name.",
        "operationId": "resources-list_resources",
        "parameters": [
          {
            "name": "provider",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "description": "Filter by provider name",
              "title": "Provider"
            },
            "description": "Filter by provider name"
          },
          {
            "name": "resource",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "description": "Filter by resource type",
              "title": "Resource"
            },
            "description": "Filter by resource type"
          },
          {
            "name": "tags",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                },
                {
                  "type": "null"
                }
              ],
              "description": "Filter by tags (all must match)",
              "title": "Tags"
            },
            "description": "Filter by tags (all must match)"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Resource"
                  },
                  "title": "Response Resources-List Resources"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/resources/{resource_id}": {
      "get": {
        "tags": [
          "resources"
        ],
        "summary": "Get Resource",
        "description": "Get resource by ID for authenticated tenant.\n\nAuthentication required. Only returns resources within user's organization namespace.\n\nReturns:\n    Resource with complete configuration and state.\n\nRaises:\n    HTTPException: 404 if resource not found.",
        "operationId": "resources-get_resource",
        "parameters": [
          {
            "name": "resource_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Resource Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Resource"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "resources"
        ],
        "summary": "Delete Resource",
        "description": "Permanently delete resource from storage for authenticated tenant.\n\nIdempotent operation - succeeds even if resource doesn't exist.\n\nAuthentication required. Only deletes resources within user's organization namespace.\n\nRaises:\n    HTTPException: 400 if deletion fails for unexpected reason.",
        "operationId": "resources-delete_resource",
        "parameters": [
          {
            "name": "resource_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Resource Id"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Successful Response"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/resources/apply": {
      "post": {
        "tags": [
          "resources"
        ],
        "summary": "Apply Resource",
        "description": "Apply resource with declarative lifecycle semantics for authenticated tenant.\n\nUsers set lifecycle_state directly in the resource:\n    - lifecycle_state=\"draft\": Store without processing (default)\n    - lifecycle_state=\"pending\": Validate deps, resolve refs, queue for processing\n\nCannot set: PROCESSING, READY, FAILED (system-only states)\nCannot modify resources in PENDING or PROCESSING state.\n\nAuthentication required. Resource applied within user's organization namespace.\n\nReturns:\n    Applied resource with timestamps and server-populated fields.\n\nRaises:\n    HTTPException: 409 if lifecycle transition invalid or resource in processing.\n        422 if dependency validation or field reference resolution fails.",
        "operationId": "resources-apply_resource",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Resource"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Resource"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/resources/register": {
      "post": {
        "tags": [
          "resources"
        ],
        "summary": "Register Resource",
        "description": "Register a new resource.\n\nRegisters a resource so that resources of this type can be created.\nProviders use this to declare what resources they can manage.\n\nAuthentication required. Resource registered within user's organization namespace.\n\nReturns:\n    The registered resource type with server-populated timestamps.\n\nRaises:\n    HTTPException: 400 if registration fails.",
        "operationId": "resources-register_resource",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ResourceDefinition"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ResourceDefinition"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/resources/unregister/{provider}/{resource}": {
      "delete": {
        "tags": [
          "resources"
        ],
        "summary": "Unregister Resource",
        "description": "Unregister a resource.\n\nIdempotent operation - succeeds even if resource doesn't exist.\nRemoves a resource registration. Existing resources of this type\nwill no longer be manageable.\n\nAuthentication required. Only unregisters resource types within user's organization namespace.\n\nRaises:\n    HTTPException: 400 if unregistration fails for unexpected reason.",
        "operationId": "resources-unregister_resource",
        "parameters": [
          {
            "name": "provider",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Provider"
            }
          },
          {
            "name": "resource",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Resource"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Successful Response"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "Body_providers-push_provider": {
        "properties": {
          "code": {
            "type": "string",
            "format": "binary",
            "title": "Code"
          }
        },
        "type": "object",
        "required": [
          "code"
        ],
        "title": "Body_providers-push_provider"
      },
      "BuildResult": {
        "properties": {
          "job_name": {
            "type": "string",
            "title": "Job Name"
          },
          "status": {
            "$ref": "#/components/schemas/BuildStatus"
          },
          "image": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Image"
          },
          "error_message": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Error Message"
          },
          "build_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Build Id"
          }
        },
        "type": "object",
        "required": [
          "job_name",
          "status"
        ],
        "title": "BuildResult",
        "description": "Result of a build status query.\n\nAttributes:\n    job_name: Unique identifier for the build job.\n    status: Current build status.\n    error_message: Error message (set on failure)."
      },
      "BuildStatus": {
        "type": "string",
        "enum": [
          "pending",
          "building",
          "success",
          "failed"
        ],
        "title": "BuildStatus",
        "description": "Status of a provider build."
      },
      "DeadLetterEvent": {
        "properties": {
          "event_id": {
            "type": "string",
            "title": "Event Id"
          },
          "tenant_id": {
            "type": "string",
            "title": "Tenant Id"
          },
          "provider": {
            "type": "string",
            "title": "Provider"
          },
          "resource_type": {
            "type": "string",
            "title": "Resource Type"
          },
          "resource_name": {
            "type": "string",
            "title": "Resource Name"
          },
          "event_type": {
            "$ref": "#/components/schemas/EventType"
          },
          "payload": {
            "additionalProperties": true,
            "type": "object",
            "title": "Payload"
          },
          "error_message": {
            "type": "string",
            "title": "Error Message"
          },
          "attempt_count": {
            "type": "integer",
            "title": "Attempt Count"
          },
          "failed_at": {
            "type": "string",
            "format": "date-time",
            "title": "Failed At"
          }
        },
        "type": "object",
        "required": [
          "event_id",
          "tenant_id",
          "provider",
          "resource_type",
          "resource_name",
          "event_type",
          "payload",
          "error_message",
          "attempt_count"
        ],
        "title": "DeadLetterEvent",
        "description": "Dead letter event for failed processing attempts.\n\nWhen a provider fails to process an event after exhausting retries,\nthe event is moved to the dead letter table for manual investigation.\n\nAttributes:\n    event_id: Original event ID.\n    tenant_id: Tenant/organization ID for multi-tenant isolation.\n    provider: Provider name (e.g., \"postgres\").\n    resource_type: Resource type (e.g., \"database\").\n    resource_name: Resource name from manifest.\n    event_type: Type of lifecycle event (CREATE, UPDATE, DELETE).\n    payload: Resource configuration as JSON object.\n    error_message: Error message from last failed attempt.\n    attempt_count: Number of processing attempts before failure.\n    failed_at: When event was moved to dead letter."
      },
      "DeployRequest": {
        "properties": {
          "version": {
            "anyOf": [
              {"type": "string"},
              {"type": "null"}
            ],
            "title": "Version",
            "description": "Version to deploy (CalVer format). If omitted, deploys the latest successful build."
          }
        },
        "type": "object",
        "title": "DeployRequest",
        "description": "Request to deploy a provider to a specific version."
      },
      "DeploymentResult": {
        "properties": {
          "deployment_name": {
            "type": "string",
            "title": "Deployment Name"
          },
          "status": {
            "$ref": "#/components/schemas/DeploymentStatus"
          },
          "available_replicas": {
            "type": "integer",
            "title": "Available Replicas",
            "default": 0
          },
          "ready_replicas": {
            "type": "integer",
            "title": "Ready Replicas",
            "default": 0
          },
          "message": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Message"
          }
        },
        "type": "object",
        "required": [
          "deployment_name",
          "status"
        ],
        "title": "DeploymentResult",
        "description": "Result of a deployment status query.\n\nAttributes:\n    deployment_name: Unique identifier for the deployment.\n    status: Current deployment status.\n    available_replicas: Number of available instances.\n    ready_replicas: Number of ready instances.\n    version: Deployed version.\n    message: Status message or error details."
      },
      "DeploymentStatus": {
        "type": "string",
        "enum": [
          "pending",
          "progressing",
          "available",
          "failed"
        ],
        "title": "DeploymentStatus",
        "description": "Status of a provider deployment."
      },
      "EventType": {
        "type": "string",
        "enum": [
          "CREATE",
          "UPDATE",
          "DELETE"
        ],
        "title": "EventType",
        "description": "Resource lifecycle event type: CREATE, UPDATE, or DELETE."
      },
      "HTTPValidationError": {
        "properties": {
          "detail": {
            "items": {
              "$ref": "#/components/schemas/ValidationError"
            },
            "type": "array",
            "title": "Detail"
          }
        },
        "type": "object",
        "title": "HTTPValidationError"
      },
      "LifecycleState": {
        "type": "string",
        "enum": [
          "draft",
          "pending",
          "processing",
          "ready",
          "failed"
        ],
        "title": "LifecycleState",
        "description": "Resource lifecycle states: DRAFT, PENDING, PROCESSING, READY, FAILED."
      },
      "OutboxEvent": {
        "properties": {
          "event_id": {
            "type": "string",
            "title": "Event Id"
          },
          "tenant_id": {
            "type": "string",
            "title": "Tenant Id"
          },
          "provider": {
            "type": "string",
            "title": "Provider"
          },
          "resource_type": {
            "type": "string",
            "title": "Resource Type"
          },
          "resource_name": {
            "type": "string",
            "title": "Resource Name"
          },
          "event_type": {
            "$ref": "#/components/schemas/EventType"
          },
          "payload": {
            "additionalProperties": true,
            "type": "object",
            "title": "Payload"
          },
          "previous_config": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Previous Config"
          },
          "correlation_id": {
            "type": "string",
            "title": "Correlation Id"
          },
          "status": {
            "$ref": "#/components/schemas/OutboxStatus",
            "default": "pending"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "title": "Created At"
          },
          "published_at": {
            "anyOf": [
              {
                "type": "string",
                "format": "date-time"
              },
              {
                "type": "null"
              }
            ],
            "title": "Published At"
          }
        },
        "type": "object",
        "required": [
          "event_id",
          "tenant_id",
          "provider",
          "resource_type",
          "resource_name",
          "event_type",
          "payload",
          "correlation_id"
        ],
        "title": "OutboxEvent",
        "description": "Outbox event for reliable event processing.\n\nAttributes:\n    event_id: Unique identifier for this event.\n    tenant_id: Tenant/organization ID.\n    provider: Provider name (e.g., \"postgres\").\n    resource_type: Resource type (e.g., \"database\").\n    resource_name: Resource name from manifest.\n    event_type: Type of lifecycle event (CREATE, UPDATE, DELETE).\n    payload: Resource configuration as JSON object.\n    previous_config: Previous configuration for UPDATE events.\n    correlation_id: Correlation ID for tracing.\n    status: Processing status (pending, published).\n    created_at: When event was created.\n    published_at: When event was processed."
      },
      "OutboxStatus": {
        "type": "string",
        "enum": [
          "pending",
          "published"
        ],
        "title": "OutboxStatus",
        "description": "Status of an outbox event.\n\nAttributes:\n    PENDING: Event created but not yet processed.\n    PUBLISHED: Event successfully processed."
      },
      "PushResponse": {
        "properties": {
          "build_id": {
            "type": "string",
            "title": "Build Id"
          },
          "job_name": {
            "type": "string",
            "title": "Job Name"
          },
          "status": {
            "$ref": "#/components/schemas/BuildStatus"
          },
          "message": {
            "type": "string",
            "title": "Message"
          }
        },
        "type": "object",
        "required": [
          "build_id",
          "job_name",
          "status",
          "message"
        ],
        "title": "PushResponse",
        "description": "Response from pushing provider code."
      },
      "Resource": {
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time",
            "title": "Created At"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "title": "Updated At"
          },
          "provider": {
            "type": "string",
            "title": "Provider"
          },
          "resource": {
            "type": "string",
            "title": "Resource"
          },
          "name": {
            "type": "string",
            "title": "Name"
          },
          "config": {
            "additionalProperties": true,
            "type": "object",
            "title": "Config",
            "default": {}
          },
          "dependencies": {
            "items": {
              "$ref": "#/components/schemas/ResourceReference"
            },
            "type": "array",
            "title": "Dependencies",
            "default": []
          },
          "outputs": {
            "additionalProperties": true,
            "type": "object",
            "title": "Outputs",
            "default": {}
          },
          "error": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Error"
          },
          "lifecycle_state": {
            "$ref": "#/components/schemas/LifecycleState",
            "default": "draft"
          },
          "pending_event_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Pending Event Id"
          },
          "tags": {
            "anyOf": [
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Tags"
          }
        },
        "type": "object",
        "required": [
          "provider",
          "resource",
          "name"
        ],
        "title": "Resource",
        "description": "Domain model for resources with provider/resource identity and 5-state lifecycle.\n\nIdentity fields (frozen - immutable after creation):\n    provider: Provider that manages this resource type.\n    resource: Resource type name.\n    name: Unique resource instance name.\n\nConfiguration fields (mutable):\n    config: Resource configuration dictionary. May contain embedded resource\n        configurations if the provider schema defines fields as resource types.\n    dependencies: References to resources this resource depends on.\n\nOutput fields (provider-managed):\n    outputs: Resource outputs from provider processing.\n    error: Error message when resource is in FAILED state.\n\nLifecycle fields (system-managed):\n    lifecycle_state: Current state (DRAFT/PENDING/PROCESSING/READY/FAILED).\n    pending_event_id: Event ID currently being processed (set on PROCESSING,\n        cleared on READY/FAILED). Used for response idempotency validation.\n\nCategorization fields (mutable):\n    tags: Optional list of tags for categorization and filtering.\n\nInherited from PragmaModel:\n    created_at: Creation timestamp (frozen).\n    updated_at: Last update timestamp (mutable)."
      },
      "ResourceDefinition": {
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time",
            "title": "Created At"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "title": "Updated At"
          },
          "provider": {
            "type": "string",
            "title": "Provider"
          },
          "resource": {
            "type": "string",
            "title": "Resource"
          },
          "schema": {
            "additionalProperties": true,
            "type": "object",
            "title": "Schema",
            "default": {}
          },
          "description": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Description"
          },
          "tags": {
            "anyOf": [
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Tags"
          }
        },
        "type": "object",
        "required": [
          "provider",
          "resource"
        ],
        "title": "ResourceDefinition",
        "description": "Domain model for resource definitions with provider/resource identity.\n\nResource definitions describe the schema and configuration for a resource type.\nProviders register resource definitions to declare what resources they can manage.\n\nIdentity fields (frozen - immutable after creation):\n    provider: Provider that manages this resource type.\n    resource: Resource type name.\n\nSchema fields (mutable):\n    schema: JSON schema defining the resource configuration structure.\n    description: Human-readable description of the resource type.\n\nCategorization fields (mutable):\n    tags: Optional list of tags for categorization and filtering.\n\nInherited from PragmaModel:\n    created_at: Creation timestamp (frozen).\n    updated_at: Last update timestamp (mutable)."
      },
      "ResourceReference": {
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time",
            "title": "Created At"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "title": "Updated At"
          },
          "provider": {
            "type": "string",
            "title": "Provider"
          },
          "resource": {
            "type": "string",
            "title": "Resource"
          },
          "name": {
            "type": "string",
            "title": "Name"
          }
        },
        "type": "object",
        "required": [
          "provider",
          "resource",
          "name"
        ],
        "title": "ResourceReference",
        "description": "Reference to another resource for dependency tracking.\n\nUsed to express dependencies between resources. At commit time,\nthe API validates that all referenced resources exist and are READY.\n\nAttributes:\n    provider: Provider that manages the referenced resource.\n    resource: Resource type name.\n    name: Resource instance name."
      },
      "ValidationError": {
        "properties": {
          "loc": {
            "items": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "integer"
                }
              ]
            },
            "type": "array",
            "title": "Location"
          },
          "msg": {
            "type": "string",
            "title": "Message"
          },
          "type": {
            "type": "string",
            "title": "Error Type"
          }
        },
        "type": "object",
        "required": [
          "loc",
          "msg",
          "type"
        ],
        "title": "ValidationError"
      }
    }
  }
}